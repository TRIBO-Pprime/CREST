<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="CREST â€“ Computational Resource for Eroded Surface Topology">
    <meta name="author" content="Arthur Francisco" >
    <link rel="icon" href="../favicon.png">

    <title>surface_analysis &ndash; CREST</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
      <link href="../css/user.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">CREST </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>surface_analysis
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 5.6% of total for procedures.">102 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mod_analyses.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mod_analyses.f90.html'>mod_analyses.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/analyses.html'>analyses</a></li>
            <li class="breadcrumb-item active" aria-current="page">surface_analysis</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/surface_analysis.html#src">surface_analysis</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine surface_analysis(app)  
</h2>
    

    <div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>The function <em>analyses</em> determinates ISO 25178 parameters of the current surface.</p>
<p>The analysis is always performed on the whole surface.
The results are written in the file which unit is <em>STA</em>.</p>
</div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-app"></span>
              integer(kind=I4),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>app</strong></td>
            <td>
                <p><em>append results to csv</em></p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~surface_analysis~~CallsGraph Pages: 1 -->
<svg id="procsurface_analysisCallsGraph" width="446pt" height="578pt"
 viewBox="0.00 0.00 446.00 578.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~surface_analysis~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 574)">
<title>proc~~surface_analysis~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-574 442,-574 442,4 -4,4"/>
<!-- proc~surface_analysis -->
<g id="proc~~surface_analysis~~CallsGraph_node1" class="node">
<title>proc~surface_analysis</title>
<polygon fill="none" stroke="black" points="92,-297 0,-297 0,-273 92,-273 92,-297"/>
<text text-anchor="middle" x="46" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50">surface_analysis</text>
</g>
<!-- abbott_param -->
<g id="proc~~surface_analysis~~CallsGraph_node2" class="node">
<title>abbott_param</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node2"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/abbott_param.html" xlink:title="abbott_param">
<polygon fill="#d9534f" stroke="#d9534f" points="239.5,-570 160.5,-570 160.5,-546 239.5,-546 239.5,-570"/>
<text text-anchor="middle" x="200" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abbott_param</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;abbott_param -->
<g id="proc~~surface_analysis~~CallsGraph_edge1" class="edge">
<title>proc~surface_analysis&#45;&gt;abbott_param</title>
<path fill="none" stroke="#ff0000" d="M47.13,-297.01C48.23,-337.14 57.32,-467.96 128,-537 134.35,-543.2 142.43,-547.58 150.86,-550.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="149.85,-554.03 160.44,-553.65 151.93,-547.35 149.85,-554.03"/>
</g>
<!-- calc_median -->
<g id="proc~~surface_analysis~~CallsGraph_node3" class="node">
<title>calc_median</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node3"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/calc_median.html" xlink:title="calc_median">
<polygon fill="#d9534f" stroke="#d9534f" points="236.5,-528 163.5,-528 163.5,-504 236.5,-504 236.5,-528"/>
<text text-anchor="middle" x="200" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_median</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;calc_median -->
<g id="proc~~surface_analysis~~CallsGraph_edge2" class="edge">
<title>proc~surface_analysis&#45;&gt;calc_median</title>
<path fill="none" stroke="#ff0000" d="M48.01,-297C51.67,-332.68 67.4,-439.09 128,-495 135.15,-501.6 144.28,-506.13 153.6,-509.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.72,-512.63 163.29,-512 154.63,-505.9 152.72,-512.63"/>
</g>
<!-- calc_moments -->
<g id="proc~~surface_analysis~~CallsGraph_node4" class="node">
<title>calc_moments</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node4"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/calc_moments.html" xlink:title="calc_moments">
<polygon fill="#d9534f" stroke="#d9534f" points="241,-486 159,-486 159,-462 241,-462 241,-486"/>
<text text-anchor="middle" x="200" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_moments</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;calc_moments -->
<g id="proc~~surface_analysis~~CallsGraph_edge3" class="edge">
<title>proc~surface_analysis&#45;&gt;calc_moments</title>
<path fill="none" stroke="#ff0000" d="M49.34,-297.23C55.91,-328.14 77.43,-410.01 128,-453 134.2,-458.27 141.67,-462.21 149.4,-465.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.31,-468.5 158.91,-468.31 150.51,-461.85 148.31,-468.5"/>
</g>
<!-- calcul_asfc_hermite -->
<g id="proc~~surface_analysis~~CallsGraph_node5" class="node">
<title>calcul_asfc_hermite</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node5"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/calcul_asfc_hermite.html" xlink:title="calcul_asfc_hermite">
<polygon fill="#d9534f" stroke="#d9534f" points="253.5,-444 146.5,-444 146.5,-420 253.5,-420 253.5,-444"/>
<text text-anchor="middle" x="200" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calcul_asfc_hermite</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;calcul_asfc_hermite -->
<g id="proc~~surface_analysis~~CallsGraph_edge4" class="edge">
<title>proc~surface_analysis&#45;&gt;calcul_asfc_hermite</title>
<path fill="none" stroke="#ff0000" d="M51.39,-297.09C61.14,-322.22 87.02,-380.26 128,-411 130.81,-413.11 133.83,-415 136.98,-416.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.61,-419.94 146.15,-421.04 138.6,-413.61 135.61,-419.94"/>
</g>
<!-- calcul_normales -->
<g id="proc~~surface_analysis~~CallsGraph_node6" class="node">
<title>calcul_normales</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node6"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/calcul_normales.html" xlink:title="calcul_normales">
<polygon fill="#d9534f" stroke="#d9534f" points="245,-402 155,-402 155,-378 245,-378 245,-402"/>
<text text-anchor="middle" x="200" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calcul_normales</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;calcul_normales -->
<g id="proc~~surface_analysis~~CallsGraph_edge5" class="edge">
<title>proc~surface_analysis&#45;&gt;calcul_normales</title>
<path fill="none" stroke="#ff0000" d="M55.49,-297.2C68.84,-315.48 96.48,-349.87 128,-369 133.34,-372.24 139.2,-375.01 145.21,-377.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.1,-380.68 154.7,-380.73 146.45,-374.09 144.1,-380.68"/>
</g>
<!-- ellipse_acf -->
<g id="proc~~surface_analysis~~CallsGraph_node7" class="node">
<title>ellipse_acf</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node7"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/ellipse_acf.html" xlink:title="ellipse_acf">
<polygon fill="#d9534f" stroke="#d9534f" points="231.5,-360 168.5,-360 168.5,-336 231.5,-336 231.5,-360"/>
<text text-anchor="middle" x="200" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ellipse_acf</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;ellipse_acf -->
<g id="proc~~surface_analysis~~CallsGraph_edge6" class="edge">
<title>proc~surface_analysis&#45;&gt;ellipse_acf</title>
<path fill="none" stroke="#ff0000" d="M67.46,-297C83.54,-306.08 106.7,-318.42 128,-327 137.66,-330.89 148.31,-334.42 158.37,-337.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.58,-340.85 168.16,-340.26 159.52,-334.12 157.58,-340.85"/>
</g>
<!-- fft_filter -->
<g id="proc~~surface_analysis~~CallsGraph_node8" class="node">
<title>fft_filter</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node8"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/fft_filter.html" xlink:title="fft_filter">
<polygon fill="#d9534f" stroke="#d9534f" points="227,-318 173,-318 173,-294 227,-294 227,-318"/>
<text text-anchor="middle" x="200" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fft_filter</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;fft_filter -->
<g id="proc~~surface_analysis~~CallsGraph_edge7" class="edge">
<title>proc~surface_analysis&#45;&gt;fft_filter</title>
<path fill="none" stroke="#ff0000" d="M92.19,-291.24C114.65,-294.35 141.43,-298.05 162.56,-300.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.35,-304.47 172.73,-302.37 163.31,-297.54 162.35,-304.47"/>
</g>
<!-- get_unit -->
<g id="proc~~surface_analysis~~CallsGraph_node9" class="node">
<title>get_unit</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node9"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/get_unit~2.html" xlink:title="get_unit">
<polygon fill="#d9534f" stroke="#d9534f" points="227,-276 173,-276 173,-252 227,-252 227,-276"/>
<text text-anchor="middle" x="200" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_unit</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;get_unit -->
<g id="proc~~surface_analysis~~CallsGraph_edge8" class="edge">
<title>proc~surface_analysis&#45;&gt;get_unit</title>
<path fill="none" stroke="#ff0000" d="M92.19,-278.76C114.65,-275.65 141.43,-271.95 162.56,-269.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="163.31,-272.46 172.73,-267.63 162.35,-265.53 163.31,-272.46"/>
</g>
<!-- indice_fractal -->
<g id="proc~~surface_analysis~~CallsGraph_node10" class="node">
<title>indice_fractal</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node10"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/indice_fractal.html" xlink:title="indice_fractal">
<polygon fill="#d9534f" stroke="#d9534f" points="238,-234 162,-234 162,-210 238,-210 238,-234"/>
<text text-anchor="middle" x="200" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indice_fractal</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;indice_fractal -->
<g id="proc~~surface_analysis~~CallsGraph_edge9" class="edge">
<title>proc~surface_analysis&#45;&gt;indice_fractal</title>
<path fill="none" stroke="#ff0000" d="M67.46,-273C83.54,-263.92 106.7,-251.58 128,-243 135.63,-239.93 143.88,-237.08 151.96,-234.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="153.14,-237.84 161.69,-231.59 151.11,-231.14 153.14,-237.84"/>
</g>
<!-- multiple_anisotropy -->
<g id="proc~~surface_analysis~~CallsGraph_node11" class="node">
<title>multiple_anisotropy</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node11"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/multiple_anisotropy.html" xlink:title="multiple_anisotropy">
<polygon fill="#d9534f" stroke="#d9534f" points="252.5,-192 147.5,-192 147.5,-168 252.5,-168 252.5,-192"/>
<text text-anchor="middle" x="200" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">multiple_anisotropy</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;multiple_anisotropy -->
<g id="proc~~surface_analysis~~CallsGraph_edge10" class="edge">
<title>proc~surface_analysis&#45;&gt;multiple_anisotropy</title>
<path fill="none" stroke="#ff0000" d="M55.49,-272.8C68.84,-254.52 96.48,-220.13 128,-201 131.15,-199.09 134.49,-197.34 137.93,-195.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.35,-198.94 147.23,-191.86 136.65,-192.48 139.35,-198.94"/>
</g>
<!-- peaks_and_pits_curvatures -->
<g id="proc~~surface_analysis~~CallsGraph_node12" class="node">
<title>peaks_and_pits_curvatures</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node12"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/peaks_and_pits_curvatures.html" xlink:title="peaks_and_pits_curvatures">
<polygon fill="#d9534f" stroke="#d9534f" points="272,-150 128,-150 128,-126 272,-126 272,-150"/>
<text text-anchor="middle" x="200" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">peaks_and_pits_curvatures</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;peaks_and_pits_curvatures -->
<g id="proc~~surface_analysis~~CallsGraph_edge11" class="edge">
<title>proc~surface_analysis&#45;&gt;peaks_and_pits_curvatures</title>
<path fill="none" stroke="#ff0000" d="M51.39,-272.91C61.14,-247.78 87.02,-189.74 128,-159 130.07,-157.45 132.25,-156.01 134.52,-154.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="136.28,-157.71 143.6,-150.05 133.1,-151.47 136.28,-157.71"/>
</g>
<!-- proc~acf_wiener -->
<g id="proc~~surface_analysis~~CallsGraph_node13" class="node">
<title>proc~acf_wiener</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node13"><a xlink:href="../proc/acf_wiener.html" xlink:title="acf_wiener">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-108 168,-108 168,-84 232,-84 232,-108"/>
<text text-anchor="middle" x="200" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">acf_wiener</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;proc~acf_wiener -->
<g id="proc~~surface_analysis~~CallsGraph_edge12" class="edge">
<title>proc~surface_analysis&#45;&gt;proc~acf_wiener</title>
<path fill="none" stroke="#ff0000" d="M49.34,-272.77C55.91,-241.86 77.43,-159.99 128,-117 136.39,-109.87 147.11,-105.16 157.66,-102.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.81,-105.37 167.65,-99.53 157.1,-98.58 158.81,-105.37"/>
</g>
<!-- surf_area -->
<g id="proc~~surface_analysis~~CallsGraph_node14" class="node">
<title>surf_area</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node14"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/surf_area.html" xlink:title="surf_area">
<polygon fill="#d9534f" stroke="#d9534f" points="229,-66 171,-66 171,-42 229,-42 229,-66"/>
<text text-anchor="middle" x="200" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">surf_area</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;surf_area -->
<g id="proc~~surface_analysis~~CallsGraph_edge13" class="edge">
<title>proc~surface_analysis&#45;&gt;surf_area</title>
<path fill="none" stroke="#ff0000" d="M48.01,-273C51.67,-237.32 67.4,-130.91 128,-75 136.99,-66.71 149.1,-61.68 160.77,-58.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.81,-61.99 170.83,-56.43 160.31,-55.15 161.81,-61.99"/>
</g>
<!-- topology -->
<g id="proc~~surface_analysis~~CallsGraph_node15" class="node">
<title>topology</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node15"><a xlink:href="https://tribo-pprime.github.io/TPGLIB/proc/topology.html" xlink:title="topology">
<polygon fill="#d9534f" stroke="#d9534f" points="227,-24 173,-24 173,0 227,0 227,-24"/>
<text text-anchor="middle" x="200" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">topology</text>
</a>
</g>
</g>
<!-- proc~surface_analysis&#45;&gt;topology -->
<g id="proc~~surface_analysis~~CallsGraph_edge14" class="edge">
<title>proc~surface_analysis&#45;&gt;topology</title>
<path fill="none" stroke="#ff0000" d="M47.13,-272.99C48.23,-232.86 57.32,-102.04 128,-33 137.27,-23.95 150.24,-18.77 162.57,-15.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="163.54,-19.19 172.67,-13.82 162.19,-12.32 163.54,-19.19"/>
</g>
<!-- calc_fftw3_real_bwd -->
<g id="proc~~surface_analysis~~CallsGraph_node16" class="node">
<title>calc_fftw3_real_bwd</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node16"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/calc_fftw3_real_bwd.html" xlink:title="calc_fftw3_real_bwd">
<polygon fill="#d9534f" stroke="#d9534f" points="427.5,-192 318.5,-192 318.5,-168 427.5,-168 427.5,-192"/>
<text text-anchor="middle" x="373" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_fftw3_real_bwd</text>
</a>
</g>
</g>
<!-- proc~acf_wiener&#45;&gt;calc_fftw3_real_bwd -->
<g id="proc~~surface_analysis~~CallsGraph_edge15" class="edge">
<title>proc~acf_wiener&#45;&gt;calc_fftw3_real_bwd</title>
<path fill="none" stroke="#b600ff" d="M232.01,-101.11C245.09,-104.26 260.03,-109.24 272,-117 292.63,-130.37 287.57,-145.33 308,-159 310.54,-160.7 313.23,-162.27 316.02,-163.73"/>
<polygon fill="#b600ff" stroke="#b600ff" points="314.6,-166.93 325.15,-167.97 317.55,-160.58 314.6,-166.93"/>
</g>
<!-- calc_fftw3_real_fwd -->
<g id="proc~~surface_analysis~~CallsGraph_node17" class="node">
<title>calc_fftw3_real_fwd</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node17"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/calc_fftw3_real_fwd.html" xlink:title="calc_fftw3_real_fwd">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-150 320,-150 320,-126 426,-126 426,-150"/>
<text text-anchor="middle" x="373" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_fftw3_real_fwd</text>
</a>
</g>
</g>
<!-- proc~acf_wiener&#45;&gt;calc_fftw3_real_fwd -->
<g id="proc~~surface_analysis~~CallsGraph_edge16" class="edge">
<title>proc~acf_wiener&#45;&gt;calc_fftw3_real_fwd</title>
<path fill="none" stroke="#b600ff" d="M232.36,-103.7C254.95,-109.25 286.09,-116.9 313.24,-123.57"/>
<polygon fill="#b600ff" stroke="#b600ff" points="312.49,-126.99 323.04,-125.97 314.16,-120.19 312.49,-126.99"/>
</g>
<!-- tab_calc_fftw3_real_bwd -->
<g id="proc~~surface_analysis~~CallsGraph_node18" class="node">
<title>tab_calc_fftw3_real_bwd</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node18"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/tab_calc_fftw3_real_bwd.html" xlink:title="tab_calc_fftw3_real_bwd">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-108 308,-108 308,-84 438,-84 438,-108"/>
<text text-anchor="middle" x="373" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tab_calc_fftw3_real_bwd</text>
</a>
</g>
</g>
<!-- proc~acf_wiener&#45;&gt;tab_calc_fftw3_real_bwd -->
<g id="proc~~surface_analysis~~CallsGraph_edge17" class="edge">
<title>proc~acf_wiener&#45;&gt;tab_calc_fftw3_real_bwd</title>
<path fill="none" stroke="#b600ff" d="M232.36,-96C250.76,-96 274.83,-96 297.8,-96"/>
<polygon fill="#b600ff" stroke="#b600ff" points="297.9,-99.5 307.9,-96 297.9,-92.5 297.9,-99.5"/>
</g>
<!-- tab_calc_fftw3_real_fwd -->
<g id="proc~~surface_analysis~~CallsGraph_node19" class="node">
<title>tab_calc_fftw3_real_fwd</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node19"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/tab_calc_fftw3_real_fwd.html" xlink:title="tab_calc_fftw3_real_fwd">
<polygon fill="#d9534f" stroke="#d9534f" points="436.5,-66 309.5,-66 309.5,-42 436.5,-42 436.5,-66"/>
<text text-anchor="middle" x="373" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tab_calc_fftw3_real_fwd</text>
</a>
</g>
</g>
<!-- proc~acf_wiener&#45;&gt;tab_calc_fftw3_real_fwd -->
<g id="proc~~surface_analysis~~CallsGraph_edge18" class="edge">
<title>proc~acf_wiener&#45;&gt;tab_calc_fftw3_real_fwd</title>
<path fill="none" stroke="#b600ff" d="M232.36,-88.3C254.95,-82.75 286.09,-75.1 313.24,-68.43"/>
<polygon fill="#b600ff" stroke="#b600ff" points="314.16,-71.81 323.04,-66.03 312.49,-65.01 314.16,-71.81"/>
</g>
<!-- trans_corner2center -->
<g id="proc~~surface_analysis~~CallsGraph_node20" class="node">
<title>trans_corner2center</title>
<g id="a_proc~~surface_analysis~~CallsGraph_node20"><a xlink:href="https://tribo-pprime.github.io/TOOLIB/proc/trans_corner2center.html" xlink:title="trans_corner2center">
<polygon fill="#d9534f" stroke="#d9534f" points="427.5,-24 318.5,-24 318.5,0 427.5,0 427.5,-24"/>
<text text-anchor="middle" x="373" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">trans_corner2center</text>
</a>
</g>
</g>
<!-- proc~acf_wiener&#45;&gt;trans_corner2center -->
<g id="proc~~surface_analysis~~CallsGraph_edge19" class="edge">
<title>proc~acf_wiener&#45;&gt;trans_corner2center</title>
<path fill="none" stroke="#b600ff" d="M232.01,-90.89C245.09,-87.74 260.03,-82.76 272,-75 292.63,-61.63 287.57,-46.67 308,-33 310.54,-31.3 313.23,-29.73 316.02,-28.27"/>
<polygon fill="#b600ff" stroke="#b600ff" points="317.55,-31.42 325.15,-24.03 314.6,-25.07 317.55,-31.42"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="29pt"
 viewBox="0.00 0.00 641.00 29.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.92 0.92) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 695.5,-28 695.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="350,-24 228,-24 228,0 350,0 350,-24"/>
<text text-anchor="middle" x="289" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="504,-24 368,-24 368,0 504,0 504,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="576,-24 522,-24 522,0 576,0 576,-24"/>
<text text-anchor="middle" x="549" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="691.5,-24 594.5,-24 594.5,0 691.5,0 691.5,-24"/>
<text text-anchor="middle" x="643" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~surface_analysis~~CalledByGraph Pages: 1 -->
<svg id="procsurface_analysisCalledByGraph" width="462pt" height="86pt"
 viewBox="0.00 0.00 462.00 85.75" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~surface_analysis~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 81.75)">
<title>proc~~surface_analysis~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-81.75 458,-81.75 458,4 -4,4"/>
<!-- proc~surface_analysis -->
<g id="proc~~surface_analysis~~CalledByGraph_node1" class="node">
<title>proc~surface_analysis</title>
<polygon fill="none" stroke="black" points="454,-66 362,-66 362,-42 454,-42 454,-66"/>
<text text-anchor="middle" x="408" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">surface_analysis</text>
</g>
<!-- proc~read_job -->
<g id="proc~~surface_analysis~~CalledByGraph_node2" class="node">
<title>proc~read_job</title>
<g id="a_proc~~surface_analysis~~CalledByGraph_node2"><a xlink:href="../proc/read_job.html" xlink:title="read_job">
<polygon fill="#d9534f" stroke="#d9534f" points="235,-66 180,-66 180,-42 235,-42 235,-66"/>
<text text-anchor="middle" x="207.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_job</text>
</a>
</g>
</g>
<!-- proc~read_job&#45;&gt;proc~surface_analysis -->
<g id="proc~~surface_analysis~~CalledByGraph_edge1" class="edge">
<title>proc~read_job&#45;&gt;proc~surface_analysis</title>
<path fill="none" stroke="#ff0000" d="M235.09,-65.05C246.01,-69.03 258.91,-73.02 271,-75 295.12,-78.94 301.75,-78.09 326,-75 336.7,-73.64 348.01,-71.29 358.68,-68.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="359.86,-71.97 368.66,-66.07 358.1,-65.19 359.86,-71.97"/>
</g>
<!-- proc~repr_img -->
<g id="proc~~surface_analysis~~CalledByGraph_node3" class="node">
<title>proc~repr_img</title>
<g id="a_proc~~surface_analysis~~CalledByGraph_node3"><a xlink:href="../proc/repr_img.html" xlink:title="repr_img">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-66 271,-66 271,-42 326,-42 326,-66"/>
<text text-anchor="middle" x="298.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">repr_img</text>
</a>
</g>
</g>
<!-- proc~read_job&#45;&gt;proc~repr_img -->
<g id="proc~~surface_analysis~~CalledByGraph_edge5" class="edge">
<title>proc~read_job&#45;&gt;proc~repr_img</title>
<path fill="none" stroke="#00ff00" d="M235.2,-54C243.21,-54 252.14,-54 260.68,-54"/>
<polygon fill="#00ff00" stroke="#00ff00" points="260.82,-57.5 270.82,-54 260.82,-50.5 260.82,-57.5"/>
</g>
<!-- proc~stat_sur -->
<g id="proc~~surface_analysis~~CalledByGraph_node4" class="node">
<title>proc~stat_sur</title>
<g id="a_proc~~surface_analysis~~CalledByGraph_node4"><a xlink:href="../proc/stat_sur.html" xlink:title="stat_sur">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-24 271.5,-24 271.5,0 325.5,0 325.5,-24"/>
<text text-anchor="middle" x="298.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stat_sur</text>
</a>
</g>
</g>
<!-- proc~read_job&#45;&gt;proc~stat_sur -->
<g id="proc~~surface_analysis~~CalledByGraph_edge6" class="edge">
<title>proc~read_job&#45;&gt;proc~stat_sur</title>
<path fill="none" stroke="#0000ff" d="M234.24,-41.85C243.1,-37.67 253.17,-32.92 262.63,-28.46"/>
<polygon fill="#0000ff" stroke="#0000ff" points="264.27,-31.55 271.82,-24.12 261.28,-25.22 264.27,-31.55"/>
</g>
<!-- proc~repr_img&#45;&gt;proc~surface_analysis -->
<g id="proc~~surface_analysis~~CalledByGraph_edge2" class="edge">
<title>proc~repr_img&#45;&gt;proc~surface_analysis</title>
<path fill="none" stroke="#ff0000" d="M326.07,-54C333.93,-54 342.85,-54 351.81,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.9,-57.5 361.9,-54 351.9,-50.5 351.9,-57.5"/>
</g>
<!-- proc~stat_sur&#45;&gt;proc~surface_analysis -->
<g id="proc~~surface_analysis~~CalledByGraph_edge3" class="edge">
<title>proc~stat_sur&#45;&gt;proc~surface_analysis</title>
<path fill="none" stroke="#ff0000" d="M325.52,-22.17C337.94,-27.02 353.08,-32.93 366.93,-38.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="365.67,-41.61 376.25,-41.99 368.21,-35.09 365.67,-41.61"/>
</g>
<!-- proc~prg_surf -->
<g id="proc~~surface_analysis~~CalledByGraph_node5" class="node">
<title>proc~prg_surf</title>
<g id="a_proc~~surface_analysis~~CalledByGraph_node5"><a xlink:href="../proc/prg_surf.html" xlink:title="prg_surf">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prg_surf</text>
</a>
</g>
</g>
<!-- proc~prg_surf&#45;&gt;proc~read_job -->
<g id="proc~~surface_analysis~~CalledByGraph_edge4" class="edge">
<title>proc~prg_surf&#45;&gt;proc~read_job</title>
<path fill="none" stroke="#ff0000" d="M144.07,-54C152.12,-54 161.14,-54 169.76,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="170,-57.5 180,-54 170,-50.5 170,-57.5"/>
</g>
<!-- program~main -->
<g id="proc~~surface_analysis~~CalledByGraph_node6" class="node">
<title>program~main</title>
<g id="a_proc~~surface_analysis~~CalledByGraph_node6"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~prg_surf -->
<g id="proc~~surface_analysis~~CalledByGraph_edge7" class="edge">
<title>program~main&#45;&gt;proc~prg_surf</title>
<path fill="none" stroke="#ff0000" d="M54.4,-54C62.39,-54 71.31,-54 79.82,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.92,-57.5 89.92,-54 79.92,-50.5 79.92,-57.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="29pt"
 viewBox="0.00 0.00 641.00 29.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.92 0.92) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 695.5,-28 695.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="350,-24 228,-24 228,0 350,0 350,-24"/>
<text text-anchor="middle" x="289" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="504,-24 368,-24 368,0 504,0 504,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="576,-24 522,-24 522,0 576,0 576,-24"/>
<text text-anchor="middle" x="549" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="691.5,-24 594.5,-24 594.5,0 691.5,0 691.5,-24"/>
<text text-anchor="middle" x="643" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">surface_analysis</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="w">   </span><span class="c">!================================================================================================</span>
<span class="w">   </span><span class="c">!&lt; @note</span>
<span class="w">   </span><span class="c">!&lt;</span>
<span class="w">   </span><span class="c">!&lt; The function *analyses* determinates ISO 25178 parameters of the current surface.</span>
<span class="w">   </span><span class="c">!&lt;</span>
<span class="w">   </span><span class="c">!&lt; The analysis is always performed on the whole surface.</span>
<span class="w">   </span><span class="c">!&lt; The results are written in the file which unit is *STA*.</span>
<span class="w">   </span><span class="c">!&lt;</span>
<span class="w">   </span><span class="c">!&lt; @endnote</span>
<span class="w">   </span><span class="c">!------------------------------------------------------------------------------------------------</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">app</span><span class="w">   </span><span class="c">!! *append results to csv*</span>

<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w"> </span><span class="n">append</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ra_t</span><span class="p">,</span><span class="w"> </span><span class="n">md</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">,</span><span class="w"> </span><span class="n">fft_cutoff</span>

<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">MOMENT_STAT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mx</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tab_tmp</span>

<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vec_heights</span><span class="p">,</span><span class="w"> </span><span class="n">tab_results</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">20</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">ana_res</span>

<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">result_str</span><span class="p">,</span><span class="w"> </span><span class="n">head</span>

<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">str</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="nb">present</span><span class="p">(</span><span class="n">app</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">         read</span><span class="p">(</span><span class="n">JOB</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">LINE_READ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LINE_READ</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="n">SPY</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;line: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">LINE_READ</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;append &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">append</span>

<span class="w">      </span><span class="k">else</span>

<span class="k">         </span><span class="n">append</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span>

<span class="w">      </span><span class="k">endif</span>

<span class="w">      </span><span class="c">! result file</span>
<span class="w">      </span><span class="k">call </span><span class="n">get_unit</span><span class="p">(</span><span class="w"> </span><span class="n">STA</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">append</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">         open</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STA</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;out/res.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;append&#39;</span><span class="p">)</span>

<span class="w">      </span><span class="k">else</span>

<span class="k">         open</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STA</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;out/res.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span>

<span class="w">      </span><span class="k">endif</span>

<span class="w">      </span><span class="c">!---------------------------------------------------------</span>

<span class="w">      </span><span class="n">ana_res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">width</span>
<span class="w">      </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">height</span>

<span class="w">      </span><span class="n">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf_dx</span>
<span class="w">      </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf_dy</span>
<span class="w">      </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">tab_results</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">vec_heights</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="n">vec_heights</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;smrk1,smrk2,spk,svk,Sk,pente,residus,coeffa_tan,coeffb_tan,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">abbott_param</span><span class="p">(</span><span class="w"> </span><span class="n">tab</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">vec_heights</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">),</span><span class="w">           </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">lg</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">nom</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;out/abbott_res.txt&quot;</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">curves</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">[.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.],</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">),</span><span class="w">                    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">omp</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w">                             </span><span class="c">!</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! smrk1, iso 25178</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! smrk2, iso 25178</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! spk  , iso 25178</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! svk  , iso 25178</span>
<span class="w">                                             </span><span class="c">! 5 et 6 pour off1 et off2</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! sk   , iso 25178</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! core slope</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="w"> </span><span class="mi">9</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! adjustment factor (tangent fit)</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! coeffa_tan        (tangent fit)</span>
<span class="w">                             </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">]</span><span class="w">   </span><span class="c">! coeffb_tan        (tangent fit)</span>

<span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">vec_heights</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Snb1,Smc1,Sk1,Snb2,Smc2,Sk2,Sdq,Scq,Sh3z,Sv3z,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">topology</span><span class="p">(</span><span class="w"> </span><span class="n">tab</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                     </span><span class="nb">long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                     </span><span class="n">larg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                     </span><span class="n">res</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">                </span><span class="c">!</span>

<span class="w">      </span><span class="n">fft_cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">5.e-6</span><span class="w"> </span><span class="c">! 5.e-6 = 5 Âµm</span>

<span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">tab_tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">fft_filter</span><span class="p">(</span><span class="n">tab</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! in</span>
<span class="w">                      </span><span class="nb">long</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! in</span>
<span class="w">                      </span><span class="n">larg</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! in</span>
<span class="w">                      </span><span class="n">cutoff</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">fft_cutoff</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! in</span>
<span class="w">                      </span><span class="n">bf_tab</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">tab_tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">         </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! out</span>
<span class="w">                      </span><span class="n">multi_fft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.)</span><span class="w">                        </span><span class="c">! in</span>

<span class="w">      </span><span class="k">call </span><span class="n">peaks_and_pits_curvatures</span><span class="p">(</span><span class="w"> </span><span class="n">heights</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">tab_tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">nx</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">ny</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">dx</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">dy</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">S_param_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">07</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">S_param_curv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">08</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">peak_curv</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">09</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                      </span><span class="n">pits_curv</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">            </span><span class="c">!</span>

<span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">tab_tmp</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Sv,Sp,Smd,Sa,Sm,Sq,Ssk,Sku,Sks,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">calc_moments</span><span class="p">(</span><span class="w"> </span><span class="n">tab</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">]</span><span class="w"> </span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">mx</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">mx</span><span class="p">,</span><span class="w">                                             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                         </span><span class="n">nb_mom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w">                                                </span><span class="c">!</span>

<span class="w">      </span><span class="k">call </span><span class="n">calc_median</span><span class="p">(</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">]</span><span class="w"> </span><span class="p">),</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                        </span><span class="n">md</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">md</span><span class="w"> </span><span class="p">)</span><span class="w">                                                   </span><span class="c">!</span>

<span class="w">      </span><span class="n">ra_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                       </span><span class="nb">maxval</span><span class="p">(</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                                     </span><span class="n">md</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">ra_t</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">si</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">sk</span><span class="p">,</span><span class="w"> </span><span class="n">mx</span><span class="p">%</span><span class="n">ku</span><span class="w"> </span><span class="p">]</span><span class="w">        </span><span class="c">!</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">     </span><span class="c">! kind of kurtosis excess</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Smbd,ordorig,R2adj,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">indice_fractal</span><span class="p">(</span><span class="w"> </span><span class="n">tab_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                           </span><span class="nb">long</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                           </span><span class="n">larg</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                           </span><span class="n">indf</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">              </span><span class="c">!</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Sh,Sdr,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">calcul_normales</span><span class="p">(</span><span class="w"> </span><span class="n">tab_in</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="nb">long</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">larg</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">scale_xyz</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="p">],</span><span class="w">           </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">cone_angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5._R8</span><span class="p">,</span><span class="w">                    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                            </span><span class="n">hori</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">                 </span><span class="c">!</span>

<span class="w">      </span><span class="k">call </span><span class="n">surf_area</span><span class="p">(</span><span class="w"> </span><span class="n">tab_in</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">         </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                      </span><span class="nb">long</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                      </span><span class="n">larg</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                      </span><span class="n">scale_xyz</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="p">],</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                      </span><span class="n">aire</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">                       </span><span class="c">!</span>



<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Sasfc,R2adj,&#39;</span>

<span class="w">      </span><span class="k">call </span><span class="n">calcul_asfc_hermite</span><span class="p">(</span><span class="w"> </span><span class="n">tab_in</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                </span><span class="n">scal</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">SCALE_IMG</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                </span><span class="n">asfc_res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<span class="w">                                </span><span class="n">omp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w">                      </span><span class="c">!</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>

<span class="w">      </span><span class="c">!-----------------------------------</span>

<span class="w">      </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="o">//</span><span class="s1">&#39;Rmax,Sal,Stri,Std,d.sl,b.sl,r.sl,r.cv,bmp,smp,rmp,bml,sml,rml,bms,sms,rms&#39;</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">PARAM</span><span class="p">%</span><span class="n">acf_surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">         call </span><span class="n">acf_wiener</span><span class="p">(</span><span class="w">  </span><span class="n">tab_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                          </span><span class="n">tab_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">acf_surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! OUT</span>
<span class="w">                                </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="w">  </span><span class="p">)</span><span class="w">                               </span><span class="c">! IN</span>

<span class="w">      </span><span class="k">endif</span>

<span class="k">      call </span><span class="n">ellipse_acf</span><span class="p">(</span><span class="w"> </span><span class="n">tabin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">acf_surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                         </span><span class="nb">long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                         </span><span class="n">larg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                        </span><span class="n">p_acv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">),</span><span class="w">                        </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! OUT -&gt; correlation lengths</span>
<span class="w">                          </span><span class="n">cut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">curr_surf</span><span class="p">%</span><span class="n">cut</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN  -&gt; z cut plane</span>
<span class="w">                     </span><span class="n">scale_xy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf_dx</span><span class="p">,</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf_dy</span><span class="p">],</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN  -&gt; lags along x and y</span>
<span class="w">                          </span><span class="n">omp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w">                                </span><span class="c">! IN  -&gt; use multithread?</span>

<span class="w">      </span><span class="n">PARAM</span><span class="p">%</span><span class="n">curr_surf</span><span class="p">%</span><span class="n">cl1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">PARAM</span><span class="p">%</span><span class="n">curr_surf</span><span class="p">%</span><span class="n">cl2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="n">PARAM</span><span class="p">%</span><span class="n">curr_surf</span><span class="p">%</span><span class="n">ang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">multiple_anisotropy</span><span class="p">(</span><span class="w"> </span><span class="n">tabin</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">PARAM</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">pp</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="nb">long</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="n">larg</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="n">scale_xy</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="p">],</span><span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="n">multi_fft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! IN</span>
<span class="w">                                </span><span class="n">vec_ani</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">             </span><span class="c">! OUT</span>

<span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">      </span><span class="n">tab_results</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ana_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">append</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="n">STA</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>


<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(E18.6)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">tab_results</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">result_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span>

<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(E18.6)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">tab_results</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">         </span><span class="n">result_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result_str</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="n">str</span>

<span class="w">      </span><span class="k">enddo</span>

<span class="k">      write</span><span class="p">(</span><span class="n">STA</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">result_str</span>

<span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">result_str</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">tab_results</span><span class="w"> </span><span class="p">)</span>

<span class="w">   </span><span class="k">return</span>
<span class="k">   endsubroutine </span><span class="n">surface_analysis</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              CREST
 was developed by Arthur Francisco<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-09-30 15:20 +0200             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>